-- LINGUAGEM SQL (LINGUAGEM ESTRUTURADA PARA CONSULTA)
-- A LING. SQL POSSUI VARIAS DIVISÕES, ONDE UMA DELAS E A DIVISÃO DDL
-- DIVISÃO DDL -> LINGUAGEM DE DEFINIÇÃO DE DADOS - A DIVISÃO DA LINGUAGEM SQL, RESPONSÁVEL PELOS
-- COMANDOS PARA CRIAÇÃO E MANUTENÇÃO DA ESTRUTURA DO BANCO DE DADOS
-- COMANDOS DA DIVISÃO DDL -> CREATE TABLE / ALTER TABLE/ DROP TABLE (CRIAR / ALTERAR / DELETAR)

-- UM ARQUIVO COM COMANDOS DA LINGUAGEM SQL É CHAMADO DE SCRIPT (IDEIA PASSO A PASSO / ROTEIRO)
-- NESTE EXEMPLO: ROTEIRO PARA CRIAÇÃO DA ESTRUTURA DO BANCO DE DADOS
-- A EXTENSÃO UTILIZADA PARA ARQUIVOS DE SCRIPT: É O .SQL

-- SUGESTÃO PARA O NOME DO ARQUIVO - SCRIPT DE CRIAÇÃO DO BD
-- NOME: SCRIPT_DDL_PROJETO_SIP.SQL
-- SUGIRO SALVAR NA MESMA PASTA QUE ESTÁ MODELAGEM

-- BOAS PRÁTICAS - RECOMENDAÇÃO PARA DISTRIBUIÇÃO DO CÓDIGO (COMANDOS) NO SCRIPT
-- QUANTO MENOR OS TRECHOS DE CÓDIGO, MAIS FÁCIL A MANUTENÇÃO
-- 1o. DEIXAR NO TOPO DO ARQUIVO, OS COMANDOS PARA DELEÇÃO DA ESTRUTURA - PARA SER UTILIZADO QUANDO NECESSARIO
-- 2o. CRIAR AS TABELAS COM OS CAMPOS, TIPO DE DADO E OBRIGATORIEDADE (ONDE SE APLICAR)
-- 3o. PARA CADA TABELA, CRIAR A CHAVE PRIMARIA CORRESPONDENTE, ATRAVÉS DE UM COMANDO DE ALTERAÇÃO
-- 4o. PARA CADA TABELA, CRIAR AS CONSTRAINTS: UNIQUE E CHECK (ONDE SE APLICAR), ATRAVÉS DE UM COMANDO DE ALTERAÇÃO
-- 5o. NO FINAL DO ARQUIVO (DEPOIS DA CRIAÇÃO DE TODAS AS TABELAS - CRIAR AS CONSTRAINTS FOREIGN KEY (CHAVES ESTRANGEIRAS) -
-- ATRAVÉS DE UM COMANDO DE ALTERAÇÃO

-- OBSERVAÇÃO: OS COMANDOS DDL NÃO SÃO CASE SENSITIVE (PODE SER ESCRITO COM LETRAS MAIUSCULAS OU MINUSCULAS)

-- COMANDOS DE DELEÇÃO DA ESTRUTURA DAS TABELAS

DROP TABLE T_SIP_DEPTO;
DROP TABLE T_SIP_FUNCIONARIO;





-- CRIAR AS TABELAS

-- CRIAR A TABELA DEPTO
CREATE TABLE T_SIP_DEPTO
(
	CD_DEPTO	NUMBER (3)	NOT NULL,
	NM_DEPTO	VARCHAR(30)	NOT NULL,
	SG_DEPTO	CHAR(3)	NOT NULL
);

-- CONSTRAINT CHAVE PRIMARIA
	ALTER TABLE T_SIP_DEPTO
ADD CONSTRAINT PK_SIP_DEPTO
	PRIMARY KEY(CD_DEPTO);

--COM COMENTARIOS
/*
ALTER TABLE T_SIP_DEPTO -- COMANDO DE ALTERAÇÃO PARA INSERIR A CHAVE PRIMARIA NA TABELA JA EXISTENTE
ADD CONSTRAINT PK_SIP_DEPTO -- ADICIONAR A CONTRAINT E INFORMAR O NOME DA CONSTRAINT 
PRIMARY KEY(CD_DEPTO); -- INFORMAR O TIPO DE CONSTRAINT E O CAMPO QUE FAZ REFERENCIA A CHAVE PRIMARIA
*/

--CONSTRAINT UNIQUE
	ALTER TABLE T_SIP_DEPTO
ADD CONSTRAINT UN_SIP_DEPTO_NOME
	UNIQUE(NM_DEPTO);

--COM COMENTARIOS
/*
ALTER TABLE T_SIP_DEPTO -- COMANDO DE ALTERAÇÃO PARA INSERIR A CONSTRAINT UNIQUE NA TABELA JA EXISTENTE 
ADD CONSTRAINT UN_SIP_DEPTO_NOME -- ADICIONAR A CONTRAINT E INFORMAR O NOME DA CONSTRAINT
UNIQUE(NM_DEPTO); -- INFORMAR O TIPO DE CONSTRAINT E O CAMPO QUE FAZ REFERENCIA A UNIQUE (CAMPO QUE NAO PODE TER REPETIÇÃO)
*/

--CRIAR TABELA FUNCIONARIO
CREATE TABLE T_SIP_FUNCIONARIO
(
	NR_MATRICULA		NUMBER(5)		NOT NULL,
	CD_DEPTO			NUMBER(3)		NOT NULL,
	NM_FUNCIONARIO		VARCHAR2(50)	NOT NULL,
	DT_NASCIMENTO		DATE			NOT NULL,
	DT_ADMISSAO			DATE        	NOT NULL,
	DS_ENDERECO			VARCHAR2(100)	NOT NULL,
	VL_SALARIO_MENSAL	NUMBER(7,2)		NOT NULL
);

--CONSTRAINT CHAVE PRIMARIA
ALTER TABLE T_SIP_FUNCIONARIO
	ADD CONSTRAINT PK_SIP_FUNCIONARIO
PRIMARY KEY(NR_MATRICULA);

--CONSTRAINT CHECK
ALTER TABLE T_SIP_FUNCIONARIO
	ADD CONSTRAINT CK_SIP_FUNC_SALARIO
CHECK (VL_SALARIO_MENSAL >= 1045);





-----------------------------------------------------------------------------
-- CRIAÇÃO DAS CONSTRAINTS CHAVES ESTRANGEIRAS - NO FINAL DO ARQUIVO 		--
-- PRECISAMOS DE TODAS AS TABELAS E CHAVES PRIMARIAS CRIADAS 				--
-- CASO CONTRARIO, NÃO E POSSÍVEL CRIAR OS RELACIONAMENTOS 					--
-----------------------------------------------------------------------------

--CRIAR O RELACIONAMENTO ENTRE FUNCIONARIO (DESTINO) E DEPARTAMENTO (ORIGEM)
ALTER TABLE T_SIP_FUNCIONARIO
ADD CONSTRAINT FK_SIP_FUNC_DEPTO
	FOREIGN KEY (CD_DEPTO)
	REFERENCES T_SIP_DEPTO (CD_DEPTO);

-- COMENTÁRIOS
/*
ALTER TABLE T_SIP_FUNCIONARIO -- COMANDO DE ALTERAÇÃO PARA INSERIR A CONSTRAINT FOREIGN KEY NA TABELA JA EXISTENTE
ADD CONSTRAINT FK_SIP_FUNC_DEPTO -- ADICIONAR A CONTRAINT E INFORMAR O NOME DA CONSTRAINT
FOREIGN KEY (CD_DEPTO) -- INFORMAR O TIPO DE CONSTRAINT FOREIGN KEY (CAMPO CHAVE ESTRANGEIRA NA TABELA ALTERADA)
REFERENCES T_SIP_DEPTO (CD_DEPTO); -- REFERENCIA (RELACIONAMENTO) A TABELA ORIGEM E RESPECTIVA CHAVE PRIMARIA
*/

/* PROXIMA AULA (20/10/2021), TENTAR FAZER:

CRIAÇÃO DAS DEMAIS TABELAS DO SIP
CRIAÇÃO DA PK, UNIQUE, CHECK
NO FINAL DO ARQUIVO P CRIAR AS FK's */

